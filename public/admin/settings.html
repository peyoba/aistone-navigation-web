<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç½‘ç«™è®¾ç½® - AI Stone æ¸¸æˆå¯¼èˆª</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
  <header class="main-header">
    <h1 class="site-title">AI Stone æ¸¸æˆå¯¼èˆª - ç½‘ç«™è®¾ç½®</h1>
    <nav class="main-nav">
      <a href="/">é¦–é¡µ</a>
      <a href="/favorites.html">æ”¶è—å¤¹</a>
      <a href="/admin/index.html" class="active">ç®¡ç†</a>
      <button id="toggleLang">English</button>
    </nav>
  </header>

  <div class="admin-container">
    <!-- ç™»å½•æ£€æŸ¥æç¤º -->
    <div id="loginAlert" class="alert alert-warning" style="display: none;">
      æ‚¨éœ€è¦å…ˆç™»å½•æ‰èƒ½è®¿é—®æ­¤é¡µé¢ã€‚<a href="/admin/index.html">å‰å¾€ç™»å½•</a>
    </div>

    <!-- ç½‘ç«™è®¾ç½®é¢æ¿ -->
    <div id="settingsPanel" class="admin-panel" style="display: none;">
      <h2 class="admin-title">ç½‘ç«™è®¾ç½®</h2>

      <!-- ç®¡ç†èœå• -->
      <div class="admin-menu">
        <div class="admin-menu-item active" data-target="generalSettings">
          <i class="icon">ğŸ”§</i>
          <span>åŸºæœ¬è®¾ç½®</span>
        </div>
        <div class="admin-menu-item" data-target="appearanceSettings">
          <i class="icon">ğŸ¨</i>
          <span>å¤–è§‚è®¾ç½®</span>
        </div>
        <div class="admin-menu-item" data-target="statisticsSettings">
          <i class="icon">ğŸ“Š</i>
          <span>ç½‘ç«™ç»Ÿè®¡</span>
        </div>
      </div>

      <!-- æç¤ºä¿¡æ¯åŒºåŸŸ -->
      <div id="alertContainer"></div>

      <!-- åŸºæœ¬è®¾ç½® -->
      <div id="generalSettings" class="settings-section">
        <h3 class="section-title">åŸºæœ¬è®¾ç½®</h3>
        <form id="generalSettingsForm" class="admin-form">
          <div class="form-group">
            <label for="siteTitleZh">ç½‘ç«™æ ‡é¢˜ï¼ˆä¸­æ–‡ï¼‰</label>
            <input type="text" id="siteTitleZh" class="form-control" value="AI Stone æ¸¸æˆå¯¼èˆª">
          </div>
          <div class="form-group">
            <label for="siteTitleEn">ç½‘ç«™æ ‡é¢˜ï¼ˆè‹±æ–‡ï¼‰</label>
            <input type="text" id="siteTitleEn" class="form-control" value="AI Stone Game Navigation">
          </div>
          <div class="form-group">
            <label for="siteDescriptionZh">ç½‘ç«™æè¿°ï¼ˆä¸­æ–‡ï¼‰</label>
            <textarea id="siteDescriptionZh" class="form-control" rows="3">AI Stone æ¸¸æˆå¯¼èˆªæ˜¯ä¸€ä¸ªé›†åˆå¤šç§åœ¨çº¿å°æ¸¸æˆçš„å¯¼èˆªç½‘ç«™ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å„ç§æœ‰è¶£çš„æ¸¸æˆã€‚</textarea>
          </div>
          <div class="form-group">
            <label for="siteDescriptionEn">ç½‘ç«™æè¿°ï¼ˆè‹±æ–‡ï¼‰</label>
            <textarea id="siteDescriptionEn" class="form-control" rows="3">AI Stone Game Navigation is a website that collects various online games. You can find many interesting games here.</textarea>
          </div>
          <div class="form-group">
            <label for="defaultLanguage">é»˜è®¤è¯­è¨€</label>
            <select id="defaultLanguage" class="form-control">
              <option value="zh">ä¸­æ–‡</option>
              <option value="en">English</option>
            </select>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary">ä¿å­˜è®¾ç½®</button>
          </div>
        </form>
      </div>

      <!-- å¤–è§‚è®¾ç½® -->
      <div id="appearanceSettings" class="settings-section" style="display: none;">
        <h3 class="section-title">å¤–è§‚è®¾ç½®</h3>
        <form id="appearanceSettingsForm" class="admin-form">
          <div class="form-group">
            <label for="themeColor">ä¸»é¢˜é¢œè‰²</label>
            <input type="color" id="themeColor" class="form-control color-picker" value="#4a6ee0">
            <div class="color-preview" style="background-color: #4a6ee0;"></div>
          </div>
          <div class="form-group">
            <label for="headerStyle">é¡¶éƒ¨å¯¼èˆªæ ·å¼</label>
            <select id="headerStyle" class="form-control">
              <option value="default">é»˜è®¤æ ·å¼</option>
              <option value="fixed">å›ºå®šé¡¶éƒ¨</option>
              <option value="transparent">é€æ˜èƒŒæ™¯</option>
            </select>
          </div>
          <div class="form-group">
            <label for="cardStyle">æ¸¸æˆå¡ç‰‡æ ·å¼</label>
            <select id="cardStyle" class="form-control">
              <option value="default">é»˜è®¤æ ·å¼</option>
              <option value="rounded">åœ†è§’æ ·å¼</option>
              <option value="bordered">è¾¹æ¡†æ ·å¼</option>
              <option value="shadow">é˜´å½±æ ·å¼</option>
            </select>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary">ä¿å­˜è®¾ç½®</button>
            <button type="button" class="btn btn-secondary" id="resetAppearance">æ¢å¤é»˜è®¤</button>
          </div>
        </form>
      </div>

      <!-- ç½‘ç«™ç»Ÿè®¡ -->
      <div id="statisticsSettings" class="settings-section" style="display: none;">
        <h3 class="section-title">ç½‘ç«™ç»Ÿè®¡</h3>
        
        <div class="stats-dashboard">
          <div class="stats-card">
            <div class="stats-title">æ¸¸æˆæ€»æ•°</div>
            <div class="stats-value" id="totalGames">0</div>
            <div class="stats-icon">ğŸ®</div>
          </div>
          <div class="stats-card">
            <div class="stats-title">åˆ†ç±»æ€»æ•°</div>
            <div class="stats-value" id="totalCategories">0</div>
            <div class="stats-icon">ğŸ“</div>
          </div>
          <div class="stats-card">
            <div class="stats-title">ç”¨æˆ·æ”¶è—</div>
            <div class="stats-value" id="totalFavorites">0</div>
            <div class="stats-icon">â­</div>
          </div>
        </div>
        
        <div class="stats-section">
          <h4>å—æ¬¢è¿æ¸¸æˆæ’è¡Œ</h4>
          <div class="table-responsive">
            <table class="admin-table" id="popularGamesTable">
              <thead>
                <tr>
                  <th style="width: 10%">æ’å</th>
                  <th style="width: 20%">æ¸¸æˆ</th>
                  <th style="width: 50%">åç§°</th>
                  <th style="width: 20%">æ”¶è—æ•°</th>
                </tr>
              </thead>
              <tbody id="popularGamesTableBody">
                <tr>
                  <td colspan="4" class="loading">
                    <div class="spinner"></div>
                    <p>åŠ è½½ç»Ÿè®¡æ•°æ®ä¸­...</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
  <script src="/js/admin.js"></script>
  <script>
    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    document.addEventListener('DOMContentLoaded', function() {
      // æ£€æŸ¥ç™»å½•çŠ¶æ€
      const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
      
      if (!isLoggedIn) {
        // æœªç™»å½•ï¼Œæ˜¾ç¤ºè­¦å‘Š
        document.getElementById('loginAlert').style.display = 'block';
      } else {
        // å·²ç™»å½•ï¼Œæ˜¾ç¤ºè®¾ç½®é¢æ¿
        document.getElementById('settingsPanel').style.display = 'block';
      }
      
      // åˆå§‹åŒ–è¯­è¨€åˆ‡æ¢æŒ‰é’®
      const toggleLangButton = document.getElementById('toggleLang');
      if (toggleLangButton) {
        toggleLangButton.addEventListener('click', toggleLanguage);
      }
      
      // åˆå§‹åŒ–è®¾ç½®èœå•åˆ‡æ¢
      initSettingsMenu();
      
      // åŠ è½½è®¾ç½®æ•°æ®
      loadSettings();
      
      // åŠ è½½ç»Ÿè®¡æ•°æ®
      loadStatistics();
      
      // åˆå§‹åŒ–è¡¨å•æäº¤äº‹ä»¶
      initForms();
    });

    /**
     * åˆå§‹åŒ–è®¾ç½®èœå•åˆ‡æ¢åŠŸèƒ½
     */
    function initSettingsMenu() {
      // è·å–æ‰€æœ‰èœå•é¡¹
      const menuItems = document.querySelectorAll('.admin-menu-item');
      const settingsSections = document.querySelectorAll('.settings-section');
      
      // ä¸ºæ¯ä¸ªèœå•é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
      menuItems.forEach(item => {
        item.addEventListener('click', function() {
          // ç§»é™¤æ‰€æœ‰èœå•é¡¹çš„æ¿€æ´»çŠ¶æ€
          menuItems.forEach(i => i.classList.remove('active'));
          
          // æ·»åŠ å½“å‰èœå•é¡¹çš„æ¿€æ´»çŠ¶æ€
          this.classList.add('active');
          
          // è·å–ç›®æ ‡è®¾ç½®åŒºåŸŸ
          const targetId = this.dataset.target;
          
          // éšè—æ‰€æœ‰è®¾ç½®åŒºåŸŸ
          settingsSections.forEach(section => {
            section.style.display = 'none';
          });
          
          // æ˜¾ç¤ºç›®æ ‡è®¾ç½®åŒºåŸŸ
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            targetSection.style.display = 'block';
          }
        });
      });
    }

    /**
     * åŠ è½½è®¾ç½®æ•°æ®
     */
    function loadSettings() {
      try {
        // åŠ è½½åŸºæœ¬è®¾ç½®
        loadGeneralSettings();
        
        // åŠ è½½å¤–è§‚è®¾ç½®
        loadAppearanceSettings();
      } catch (error) {
        console.error('åŠ è½½è®¾ç½®å¤±è´¥:', error);
        showAlert('åŠ è½½è®¾ç½®æ•°æ®å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚', 'danger');
      }
    }

    /**
     * åŠ è½½åŸºæœ¬è®¾ç½®
     */
    function loadGeneralSettings() {
      // ä»æœ¬åœ°å­˜å‚¨è·å–è®¾ç½®
      const settings = JSON.parse(localStorage.getItem('siteSettings') || '{}');
      
      // å¡«å……è¡¨å•å­—æ®µ
      if (settings.siteTitle) {
        document.getElementById('siteTitleZh').value = settings.siteTitle.zh || 'AI Stone æ¸¸æˆå¯¼èˆª';
        document.getElementById('siteTitleEn').value = settings.siteTitle.en || 'AI Stone Game Navigation';
      }
      
      if (settings.siteDescription) {
        document.getElementById('siteDescriptionZh').value = settings.siteDescription.zh || 
          'AI Stone æ¸¸æˆå¯¼èˆªæ˜¯ä¸€ä¸ªé›†åˆå¤šç§åœ¨çº¿å°æ¸¸æˆçš„å¯¼èˆªç½‘ç«™ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å„ç§æœ‰è¶£çš„æ¸¸æˆã€‚';
        document.getElementById('siteDescriptionEn').value = settings.siteDescription.en || 
          'AI Stone Game Navigation is a website that collects various online games. You can find many interesting games here.';
      }
      
      if (settings.defaultLanguage) {
        document.getElementById('defaultLanguage').value = settings.defaultLanguage;
      }
    }

    /**
     * åŠ è½½å¤–è§‚è®¾ç½®
     */
    function loadAppearanceSettings() {
      // ä»æœ¬åœ°å­˜å‚¨è·å–è®¾ç½®
      const settings = JSON.parse(localStorage.getItem('siteSettings') || '{}');
      
      // å¡«å……è¡¨å•å­—æ®µ
      if (settings.appearance) {
        if (settings.appearance.themeColor) {
          document.getElementById('themeColor').value = settings.appearance.themeColor;
          document.querySelector('.color-preview').style.backgroundColor = settings.appearance.themeColor;
        }
        
        if (settings.appearance.headerStyle) {
          document.getElementById('headerStyle').value = settings.appearance.headerStyle;
        }
        
        if (settings.appearance.cardStyle) {
          document.getElementById('cardStyle').value = settings.appearance.cardStyle;
        }
      }
      
      // ä¸ºé¢œè‰²é€‰æ‹©å™¨æ·»åŠ äº‹ä»¶ç›‘å¬
      document.getElementById('themeColor').addEventListener('input', function() {
        document.querySelector('.color-preview').style.backgroundColor = this.value;
      });
      
      // ä¸ºé‡ç½®æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬
      document.getElementById('resetAppearance').addEventListener('click', function() {
        document.getElementById('themeColor').value = '#4a6ee0';
        document.querySelector('.color-preview').style.backgroundColor = '#4a6ee0';
        document.getElementById('headerStyle').value = 'default';
        document.getElementById('cardStyle').value = 'default';
      });
    }

    /**
     * åˆå§‹åŒ–è¡¨å•æäº¤äº‹ä»¶
     */
    function initForms() {
      // åŸºæœ¬è®¾ç½®è¡¨å•æäº¤
      document.getElementById('generalSettingsForm').addEventListener('submit', function(e) {
        e.preventDefault();
        saveGeneralSettings();
      });
      
      // å¤–è§‚è®¾ç½®è¡¨å•æäº¤
      document.getElementById('appearanceSettingsForm').addEventListener('submit', function(e) {
        e.preventDefault();
        saveAppearanceSettings();
      });
    }

    /**
     * ä¿å­˜åŸºæœ¬è®¾ç½®
     */
    function saveGeneralSettings() {
      try {
        // è·å–è®¾ç½®å€¼
        const siteTitleZh = document.getElementById('siteTitleZh').value;
        const siteTitleEn = document.getElementById('siteTitleEn').value;
        const siteDescriptionZh = document.getElementById('siteDescriptionZh').value;
        const siteDescriptionEn = document.getElementById('siteDescriptionEn').value;
        const defaultLanguage = document.getElementById('defaultLanguage').value;
        
        // ä»æœ¬åœ°å­˜å‚¨è·å–ç°æœ‰è®¾ç½®
        const settings = JSON.parse(localStorage.getItem('siteSettings') || '{}');
        
        // æ›´æ–°è®¾ç½®
        settings.siteTitle = {
          zh: siteTitleZh,
          en: siteTitleEn
        };
        
        settings.siteDescription = {
          zh: siteDescriptionZh,
          en: siteDescriptionEn
        };
        
        settings.defaultLanguage = defaultLanguage;
        settings.lastUpdated = new Date().toISOString();
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        localStorage.setItem('siteSettings', JSON.stringify(settings));
        
        // åº”ç”¨è®¾ç½®åˆ°ç½‘ç«™
        applySettings(settings);
        
        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        showAlert('åŸºæœ¬è®¾ç½®å·²ä¿å­˜ï¼', 'success');
      } catch (error) {
        console.error('ä¿å­˜è®¾ç½®å¤±è´¥:', error);
        showAlert('ä¿å­˜è®¾ç½®å¤±è´¥ã€‚', 'danger');
      }
    }

    /**
     * ä¿å­˜å¤–è§‚è®¾ç½®
     */
    function saveAppearanceSettings() {
      try {
        // è·å–è®¾ç½®å€¼
        const themeColor = document.getElementById('themeColor').value;
        const headerStyle = document.getElementById('headerStyle').value;
        const cardStyle = document.getElementById('cardStyle').value;
        
        // ä»æœ¬åœ°å­˜å‚¨è·å–ç°æœ‰è®¾ç½®
        const settings = JSON.parse(localStorage.getItem('siteSettings') || '{}');
        
        // ç¡®ä¿appearanceå¯¹è±¡å­˜åœ¨
        if (!settings.appearance) {
          settings.appearance = {};
        }
        
        // æ›´æ–°è®¾ç½®
        settings.appearance.themeColor = themeColor;
        settings.appearance.headerStyle = headerStyle;
        settings.appearance.cardStyle = cardStyle;
        settings.lastUpdated = new Date().toISOString();
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        localStorage.setItem('siteSettings', JSON.stringify(settings));
        
        // åº”ç”¨è®¾ç½®åˆ°ç½‘ç«™
        applySettings(settings);
        
        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        showAlert('å¤–è§‚è®¾ç½®å·²ä¿å­˜ï¼', 'success');
      } catch (error) {
        console.error('ä¿å­˜è®¾ç½®å¤±è´¥:', error);
        showAlert('ä¿å­˜è®¾ç½®å¤±è´¥ã€‚', 'danger');
      }
    }

    /**
     * åº”ç”¨è®¾ç½®åˆ°ç½‘ç«™
     * @param {Object} settings - ç½‘ç«™è®¾ç½®å¯¹è±¡
     */
    function applySettings(settings) {
      // åº”ç”¨æ ‡é¢˜
      if (settings.siteTitle) {
        const currentLang = localStorage.getItem('locale') || 'zh';
        document.title = settings.siteTitle[currentLang] || settings.siteTitle.zh;
      }
      
      // åº”ç”¨ä¸»é¢˜é¢œè‰²
      if (settings.appearance && settings.appearance.themeColor) {
        document.documentElement.style.setProperty('--primary-color', settings.appearance.themeColor);
      }
    }

    /**
     * åŠ è½½ç»Ÿè®¡æ•°æ®
     */
    function loadStatistics() {
      try {
        // åŠ è½½æ¸¸æˆæ•°æ®
        let games = [];
        if (window.gamesData && Array.isArray(window.gamesData)) {
          games = window.gamesData;
        }
        
        // åŠ è½½åˆ†ç±»æ•°æ®
        let categories = [];
        if (window.categoriesData && Array.isArray(window.categoriesData)) {
          categories = window.categoriesData;
        } else if (window.appData && window.appData.categories) {
          categories = window.appData.categories;
        }
        
        // è·å–è‡ªå®šä¹‰åˆ†ç±»
        const customCategoriesStr = localStorage.getItem('customCategories');
        const customCategories = customCategoriesStr ? JSON.parse(customCategoriesStr) : [];
        
        // åˆå¹¶åˆ†ç±»
        categories = [...categories, ...customCategories];
        
        // è·å–æ”¶è—æ•°æ®
        let favorites = [];
        const favoritesStr = localStorage.getItem('favorites');
        if (favoritesStr) {
          favorites = JSON.parse(favoritesStr);
        }
        
        // æ›´æ–°æ¸¸æˆæ€»æ•°
        document.getElementById('totalGames').textContent = games.length;
        
        // æ›´æ–°åˆ†ç±»æ€»æ•°
        document.getElementById('totalCategories').textContent = categories.length;
        
        // æ›´æ–°æ”¶è—æ€»æ•°
        document.getElementById('totalFavorites').textContent = favorites.length;
        
        // ç”Ÿæˆæ¸¸æˆæ”¶è—æ’è¡Œæ¦œ
        generatePopularGamesTable(games, favorites);
        
      } catch (error) {
        console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
        showAlert('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚', 'danger');
      }
    }

    /**
     * ç”Ÿæˆçƒ­é—¨æ¸¸æˆè¡¨æ ¼
     * @param {Array} games - æ¸¸æˆæ•°ç»„
     * @param {Array} favorites - æ”¶è—æ•°ç»„
     */
    function generatePopularGamesTable(games, favorites) {
      const tableBody = document.getElementById('popularGamesTableBody');
      const currentLang = localStorage.getItem('locale') || 'zh';
      
      // æ¸…ç©ºè¡¨æ ¼å†…å®¹
      tableBody.innerHTML = '';
      
      if (!games || games.length === 0) {
        // å¦‚æœæ²¡æœ‰æ¸¸æˆï¼Œæ˜¾ç¤ºç©ºæ¶ˆæ¯
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = `
          <td colspan="4" style="text-align: center; padding: 30px;">
            æš‚æ— æ¸¸æˆæ•°æ®ã€‚
          </td>
        `;
        tableBody.appendChild(emptyRow);
        return;
      }
      
      // è®¡ç®—æ¯ä¸ªæ¸¸æˆçš„æ”¶è—æ¬¡æ•°
      const gameFavoriteCounts = {};
      games.forEach(game => {
        gameFavoriteCounts[game.id] = 0;
      });
      
      // è®¡ç®—æ”¶è—æ¬¡æ•°
      favorites.forEach(favoriteId => {
        if (gameFavoriteCounts[favoriteId] !== undefined) {
          gameFavoriteCounts[favoriteId]++;
        }
      });
      
      // æŒ‰æ”¶è—æ¬¡æ•°æ’åº
      const sortedGames = [...games].sort((a, b) => {
        return gameFavoriteCounts[b.id] - gameFavoriteCounts[a.id];
      });
      
      // åªæ˜¾ç¤ºå‰10ä¸ª
      const topGames = sortedGames.slice(0, 10);
      
      // ç”Ÿæˆè¡¨æ ¼è¡Œ
      topGames.forEach((game, index) => {
        const row = document.createElement('tr');
        
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>
            <img src="${game.thumbnail || '/images/placeholder.jpg'}" alt="${game.title[currentLang] || game.title.en}" class="game-thumbnail">
          </td>
          <td>${game.title[currentLang] || game.title.en}</td>
          <td>${gameFavoriteCounts[game.id]}</td>
        `;
        
        tableBody.appendChild(row);
      });
    }

    /**
     * æ˜¾ç¤ºæé†’æ¶ˆæ¯
     * @param {string} message - æ¶ˆæ¯æ–‡æœ¬
     * @param {string} type - æ¶ˆæ¯ç±»å‹ (success, danger, warning, info)
     */
    function showAlert(message, type) {
      const alertContainer = document.getElementById('alertContainer');
      
      const alert = document.createElement('div');
      alert.className = `alert alert-${type}`;
      alert.textContent = message;
      
      // æ·»åŠ å…³é—­æŒ‰é’®
      const closeBtn = document.createElement('span');
      closeBtn.style.float = 'right';
      closeBtn.style.cursor = 'pointer';
      closeBtn.textContent = 'Ã—';
      closeBtn.addEventListener('click', function() {
        alert.remove();
      });
      
      alert.appendChild(closeBtn);
      alertContainer.prepend(alert);
      
      // 5ç§’åè‡ªåŠ¨å…³é—­
      setTimeout(function() {
        if (alert.parentNode) {
          alert.remove();
        }
      }, 5000);
    }

    /**
     * åˆ‡æ¢ç•Œé¢è¯­è¨€
     */
    function toggleLanguage() {
      // è·å–å½“å‰è¯­è¨€
      let currentLang = localStorage.getItem('locale') || 'zh';
      
      // åˆ‡æ¢è¯­è¨€
      currentLang = currentLang === 'zh' ? 'en' : 'zh';
      localStorage.setItem('locale', currentLang);
      
      // æ›´æ–°æŒ‰é’®æ–‡æœ¬
      document.getElementById('toggleLang').textContent = currentLang === 'zh' ? 'English' : 'ä¸­æ–‡';
      
      // åˆ·æ–°é¡µé¢æ˜¾ç¤º
      loadStatistics();
      updateUIText();
    }

    /**
     * æ›´æ–°ç•Œé¢æ–‡æœ¬
     */
    function updateUIText() {
      const currentLang = localStorage.getItem('locale') || 'zh';
      
      const translations = {
        zh: {
          'settings.title': 'AI Stone æ¸¸æˆå¯¼èˆª - ç½‘ç«™è®¾ç½®',
          'settings.heading': 'ç½‘ç«™è®¾ç½®',
          'settings.general': 'åŸºæœ¬è®¾ç½®',
          'settings.appearance': 'å¤–è§‚è®¾ç½®',
          'settings.statistics': 'ç½‘ç«™ç»Ÿè®¡',
          'settings.save': 'ä¿å­˜è®¾ç½®',
          'settings.reset': 'æ¢å¤é»˜è®¤',
          'stats.games': 'æ¸¸æˆæ€»æ•°',
          'stats.categories': 'åˆ†ç±»æ€»æ•°',
          'stats.favorites': 'ç”¨æˆ·æ”¶è—',
          'stats.popular': 'å—æ¬¢è¿æ¸¸æˆæ’è¡Œ',
          'stats.rank': 'æ’å',
          'stats.game': 'æ¸¸æˆ',
          'stats.name': 'åç§°',
          'stats.favCount': 'æ”¶è—æ•°',
          'nav.home': 'é¦–é¡µ',
          'nav.favorites': 'æ”¶è—å¤¹',
          'nav.admin': 'ç®¡ç†'
        },
        en: {
          'settings.title': 'AI Stone Game Navigation - Website Settings',
          'settings.heading': 'Website Settings',
          'settings.general': 'General Settings',
          'settings.appearance': 'Appearance Settings',
          'settings.statistics': 'Website Statistics',
          'settings.save': 'Save Settings',
          'settings.reset': 'Reset to Default',
          'stats.games': 'Total Games',
          'stats.categories': 'Total Categories',
          'stats.favorites': 'User Favorites',
          'stats.popular': 'Popular Games Ranking',
          'stats.rank': 'Rank',
          'stats.game': 'Game',
          'stats.name': 'Name',
          'stats.favCount': 'Favorites',
          'nav.home': 'Home',
          'nav.favorites': 'Favorites',
          'nav.admin': 'Admin'
        }
      };
      
      // è®¾ç½®é¡µé¢æ ‡é¢˜
      document.title = translations[currentLang]['settings.title'];
      document.querySelector('.site-title').textContent = translations[currentLang]['settings.title'];
      
      // æ›´æ–°å¯¼èˆªé“¾æ¥
      const navLinks = document.querySelectorAll('.main-nav a');
      navLinks[0].textContent = translations[currentLang]['nav.home'];
      navLinks[1].textContent = translations[currentLang]['nav.favorites'];
      navLinks[2].textContent = translations[currentLang]['nav.admin'];
      
      // æ›´æ–°è®¾ç½®æ ‡é¢˜
      document.querySelector('.admin-title').textContent = translations[currentLang]['settings.heading'];
      
      // æ›´æ–°èœå•é¡¹
      const menuItems = document.querySelectorAll('.admin-menu-item span');
      menuItems[0].textContent = translations[currentLang]['settings.general'];
      menuItems[1].textContent = translations[currentLang]['settings.appearance'];
      menuItems[2].textContent = translations[currentLang]['settings.statistics'];
      
      // æ›´æ–°åŒºåŸŸæ ‡é¢˜
      document.querySelectorAll('.section-title')[0].textContent = translations[currentLang]['settings.general'];
      document.querySelectorAll('.section-title')[1].textContent = translations[currentLang]['settings.appearance'];
      document.querySelectorAll('.section-title')[2].textContent = translations[currentLang]['settings.statistics'];
      
      // æ›´æ–°æŒ‰é’®æ–‡æœ¬
      document.querySelectorAll('.btn-primary').forEach(btn => {
        if (btn.type === 'submit') {
          btn.textContent = translations[currentLang]['settings.save'];
        }
      });
      
      document.getElementById('resetAppearance').textContent = translations[currentLang]['settings.reset'];
      
      // æ›´æ–°ç»Ÿè®¡å¡ç‰‡æ ‡é¢˜
      document.querySelectorAll('.stats-title')[0].textContent = translations[currentLang]['stats.games'];
      document.querySelectorAll('.stats-title')[1].textContent = translations[currentLang]['stats.categories'];
      document.querySelectorAll('.stats-title')[2].textContent = translations[currentLang]['stats.favorites'];
      
      // æ›´æ–°ç»Ÿè®¡è¡¨æ ¼æ ‡é¢˜
      document.querySelector('.stats-section h4').textContent = translations[currentLang]['stats.popular'];
      
      // æ›´æ–°è¡¨æ ¼åˆ—æ ‡é¢˜
      const tableHeaders = document.querySelectorAll('#popularGamesTable th');
      tableHeaders[0].textContent = translations[currentLang]['stats.rank'];
      tableHeaders[1].textContent = translations[currentLang]['stats.game'];
      tableHeaders[2].textContent = translations[currentLang]['stats.name'];
      tableHeaders[3].textContent = translations[currentLang]['stats.favCount'];
    }
  </script>
</body>
</html> 