<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åˆ†ç±»ç®¡ç† - AI Stone æ¸¸æˆå¯¼èˆª</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
  <header class="main-header">
    <h1 class="site-title">AI Stone æ¸¸æˆå¯¼èˆª - åˆ†ç±»ç®¡ç†</h1>
    <nav class="main-nav">
      <a href="/">é¦–é¡µ</a>
      <a href="/favorites.html">æ”¶è—å¤¹</a>
      <a href="/admin/index.html" class="active">ç®¡ç†</a>
      <button id="toggleLang">English</button>
    </nav>
  </header>

  <div class="admin-container">
    <!-- ç™»å½•æ£€æŸ¥æç¤º -->
    <div id="loginAlert" class="alert alert-warning" style="display: none;">
      æ‚¨éœ€è¦å…ˆç™»å½•æ‰èƒ½è®¿é—®æ­¤é¡µé¢ã€‚<a href="/admin/index.html">å‰å¾€ç™»å½•</a>
    </div>

    <!-- åˆ†ç±»ç®¡ç†é¢æ¿ -->
    <div id="categoriesPanel" class="admin-panel" style="display: none;">
      <h2 class="admin-title">åˆ†ç±»ç®¡ç†</h2>

      <!-- æ“ä½œæ  -->
      <div class="admin-actions">
        <div class="search-box">
          <input type="text" id="searchCategories" class="form-control" placeholder="æœç´¢åˆ†ç±»...">
        </div>
        <div class="action-buttons">
          <button class="btn btn-primary" onclick="openAddModal()">æ·»åŠ åˆ†ç±»</button>
        </div>
      </div>

      <!-- æç¤ºä¿¡æ¯åŒºåŸŸ -->
      <div id="alertContainer"></div>

      <!-- åˆ†ç±»åˆ—è¡¨ -->
      <div class="categories-table-container">
        <table class="admin-table" id="categoriesTable">
          <thead>
            <tr>
              <th style="width: 10%">ID</th>
              <th style="width: 25%">ä¸­æ–‡åç§°</th>
              <th style="width: 25%">è‹±æ–‡åç§°</th>
              <th style="width: 20%">æ¸¸æˆæ•°é‡</th>
              <th style="width: 20%">æ“ä½œ</th>
            </tr>
          </thead>
          <tbody id="categoriesTableBody">
            <!-- åˆ†ç±»åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€åŠ è½½ -->
            <tr>
              <td colspan="5" class="loading">
                <div class="spinner"></div>
                <p>åŠ è½½åˆ†ç±»æ•°æ®ä¸­...</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- æ·»åŠ /ç¼–è¾‘åˆ†ç±»å¯¹è¯æ¡† -->
    <div id="categoryModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle">æ·»åŠ åˆ†ç±»</h3>
          <span class="close-modal">&times;</span>
        </div>
        <div class="modal-body">
          <form id="categoryForm" class="admin-form">
            <input type="hidden" id="categoryId">

            <div class="form-group">
              <label for="categoryNameZh">åˆ†ç±»åç§°ï¼ˆä¸­æ–‡ï¼‰</label>
              <input type="text" id="categoryNameZh" class="form-control" required>
            </div>

            <div class="form-group">
              <label for="categoryNameEn">åˆ†ç±»åç§°ï¼ˆè‹±æ–‡ï¼‰</label>
              <input type="text" id="categoryNameEn" class="form-control" required>
            </div>

            <div class="form-group">
              <label for="categoryDesc">åˆ†ç±»æè¿°ï¼ˆå¯é€‰ï¼‰</label>
              <textarea id="categoryDesc" class="form-control"></textarea>
            </div>

            <div class="form-group">
              <button type="submit" class="btn btn-primary">ä¿å­˜</button>
              <button type="button" class="btn btn-secondary close-modal">å–æ¶ˆ</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- åˆ é™¤ç¡®è®¤å¯¹è¯æ¡† -->
    <div id="deleteConfirmModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ç¡®è®¤åˆ é™¤</h3>
          <span class="close-modal">&times;</span>
        </div>
        <div class="modal-body">
          <p>æ‚¨ç¡®å®šè¦åˆ é™¤åˆ†ç±» "<span id="deleteCategoryName"></span>" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚</p>
          <div class="form-group">
            <button id="confirmDeleteBtn" class="btn btn-danger">ç¡®è®¤åˆ é™¤</button>
            <button class="btn btn-secondary close-modal">å–æ¶ˆ</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
  <script src="/js/admin.js"></script>
  <script>
    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    document.addEventListener('DOMContentLoaded', function() {
      // æ£€æŸ¥ç™»å½•çŠ¶æ€
      const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
      
      if (!isLoggedIn) {
        // æœªç™»å½•ï¼Œæ˜¾ç¤ºè­¦å‘Š
        document.getElementById('loginAlert').style.display = 'block';
      } else {
        // å·²ç™»å½•ï¼Œæ˜¾ç¤ºåˆ†ç±»ç®¡ç†é¢æ¿
        document.getElementById('categoriesPanel').style.display = 'block';
        
        // åŠ è½½åˆ†ç±»æ•°æ®
        loadCategoriesList();
        
        // åˆå§‹åŒ–æœç´¢åŠŸèƒ½
        initSearch();
        
        // åˆå§‹åŒ–æ¨¡æ€æ¡†
        initModals();
      }
      
      // åˆå§‹åŒ–è¯­è¨€åˆ‡æ¢æŒ‰é’®
      const toggleLangButton = document.getElementById('toggleLang');
      if (toggleLangButton) {
        toggleLangButton.addEventListener('click', toggleLanguage);
      }
    });

    /**
     * åŠ è½½åˆ†ç±»åˆ—è¡¨
     */
    function loadCategoriesList() {
      try {
        // è·å–åˆ†ç±»æ•°æ®
        let categories = [];
        if (window.categoriesData && Array.isArray(window.categoriesData)) {
          categories = window.categoriesData;
        } else if (window.appData && window.appData.categories) {
          categories = window.appData.categories;
        }

        // è·å–è‡ªå®šä¹‰åˆ†ç±»
        const customCategoriesStr = localStorage.getItem('customCategories');
        const customCategories = customCategoriesStr ? JSON.parse(customCategoriesStr) : [];

        // åˆå¹¶æ‰€æœ‰åˆ†ç±»æ•°æ®
        categories = [...categories, ...customCategories];

        // æ¸²æŸ“åˆ†ç±»è¡¨æ ¼
        renderCategoriesTable(categories);
      } catch (error) {
        console.error('åŠ è½½åˆ†ç±»åˆ—è¡¨å¤±è´¥:', error);
        showAlert('åŠ è½½åˆ†ç±»æ•°æ®å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚', 'danger');
      }
    }

    /**
     * æ¸²æŸ“åˆ†ç±»è¡¨æ ¼
     * @param {Array} categories - åˆ†ç±»æ•°æ®æ•°ç»„
     */
    function renderCategoriesTable(categories) {
      const tableBody = document.getElementById('categoriesTableBody');
      const currentLang = localStorage.getItem('locale') || 'zh';

      // æ¸…ç©ºè¡¨æ ¼å†…å®¹
      tableBody.innerHTML = '';

      if (!categories || categories.length === 0) {
        // å¦‚æœæ²¡æœ‰åˆ†ç±»ï¼Œæ˜¾ç¤ºç©ºæ¶ˆæ¯
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = `
          <td colspan="5" style="text-align: center; padding: 30px;">
            æš‚æ— åˆ†ç±»æ•°æ®ã€‚ç‚¹å‡»"æ·»åŠ åˆ†ç±»"æŒ‰é’®åˆ›å»ºæ–°åˆ†ç±»ã€‚
          </td>
        `;
        tableBody.appendChild(emptyRow);
        return;
      }

      // è®¡ç®—æ¯ä¸ªåˆ†ç±»ä¸‹çš„æ¸¸æˆæ•°é‡
      const categoryGameCounts = {};
      if (window.gamesData) {
        window.gamesData.forEach(game => {
          if (game.category) {
            categoryGameCounts[game.category] = (categoryGameCounts[game.category] || 0) + 1;
          }
        });
      }

      // ä¸ºæ¯ä¸ªåˆ†ç±»åˆ›å»ºè¡¨æ ¼è¡Œ
      categories.forEach((category, index) => {
        const row = document.createElement('tr');
        row.dataset.categoryId = category.id;

        // åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªå®šä¹‰åˆ†ç±»
        const isCustomCategory = !!(localStorage.getItem('customCategories') &&
          JSON.parse(localStorage.getItem('customCategories')).find(c => c.id === category.id));

        row.innerHTML = `
          <td>${category.id}</td>
          <td>${category.name.zh || '-'}</td>
          <td>${category.name.en || '-'}</td>
          <td>${categoryGameCounts[category.id] || 0}</td>
          <td class="table-actions">
            ${isCustomCategory ? `
              <button class="btn btn-primary btn-sm edit-category" data-id="${category.id}" title="ç¼–è¾‘åˆ†ç±»">âœï¸</button>
              <button class="btn btn-danger btn-sm delete-category" data-id="${category.id}" title="åˆ é™¤åˆ†ç±»">ğŸ—‘ï¸</button>
            ` : `
              <button class="btn btn-secondary btn-sm" disabled title="å†…ç½®åˆ†ç±»æ— æ³•ä¿®æ”¹">ğŸ”’</button>
            `}
          </td>
        `;

        tableBody.appendChild(row);
      });

      // ä¸ºæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      addTableButtonListeners();
    }

    /**
     * ä¸ºè¡¨æ ¼ä¸­çš„æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
     */
    function addTableButtonListeners() {
      // ç¼–è¾‘åˆ†ç±»æŒ‰é’®
      document.querySelectorAll('.edit-category').forEach(button => {
        button.addEventListener('click', function() {
          const categoryId = this.dataset.id;
          openEditModal(categoryId);
        });
      });

      // åˆ é™¤åˆ†ç±»æŒ‰é’®
      document.querySelectorAll('.delete-category').forEach(button => {
        button.addEventListener('click', function() {
          const categoryId = this.dataset.id;
          openDeleteModal(categoryId);
        });
      });
    }

    /**
     * åˆå§‹åŒ–æœç´¢åŠŸèƒ½
     */
    function initSearch() {
      const searchInput = document.getElementById('searchCategories');
      if (searchInput) {
        searchInput.addEventListener('input', function() {
          const searchTerm = this.value.toLowerCase();
          filterCategories(searchTerm);
        });
      }
    }

    /**
     * æ ¹æ®æœç´¢è¯è¿‡æ»¤åˆ†ç±»
     * @param {string} searchTerm - æœç´¢è¯
     */
    function filterCategories(searchTerm) {
      const rows = document.querySelectorAll('#categoriesTableBody tr');
      
      rows.forEach(row => {
        const categoryNameZh = row.cells[1]?.textContent.toLowerCase() || '';
        const categoryNameEn = row.cells[2]?.textContent.toLowerCase() || '';
        
        if (categoryNameZh.includes(searchTerm) || categoryNameEn.includes(searchTerm)) {
          row.style.display = '';
        } else {
          row.style.display = 'none';
        }
      });
    }

    /**
     * åˆå§‹åŒ–æ¨¡æ€æ¡†
     */
    function initModals() {
      // è·å–æ‰€æœ‰æ¨¡æ€æ¡†
      const modals = document.querySelectorAll('.modal');
      
      modals.forEach(modal => {
        // å…³é—­æŒ‰é’®äº‹ä»¶
        const closeButtons = modal.querySelectorAll('.close-modal');
        closeButtons.forEach(button => {
          button.addEventListener('click', function() {
            modal.style.display = 'none';
          });
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.addEventListener('click', function(event) {
          if (event.target === modal) {
            modal.style.display = 'none';
          }
        });
      });

      // åˆ†ç±»è¡¨å•æäº¤äº‹ä»¶
      const form = document.getElementById('categoryForm');
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        saveCategory();
      });
    }

    /**
     * æ‰“å¼€æ·»åŠ åˆ†ç±»å¯¹è¯æ¡†
     */
    function openAddModal() {
      // é‡ç½®è¡¨å•
      document.getElementById('categoryForm').reset();
      document.getElementById('categoryId').value = '';
      document.getElementById('modalTitle').textContent = 'æ·»åŠ åˆ†ç±»';

      // æ˜¾ç¤ºå¯¹è¯æ¡†
      document.getElementById('categoryModal').style.display = 'block';
    }

    /**
     * æ‰“å¼€ç¼–è¾‘åˆ†ç±»å¯¹è¯æ¡†
     * @param {string} categoryId - åˆ†ç±»ID
     */
    function openEditModal(categoryId) {
      // è·å–åˆ†ç±»æ•°æ®
      const customCategories = JSON.parse(localStorage.getItem('customCategories') || '[]');
      const category = customCategories.find(c => c.id === categoryId);

      if (!category) {
        showAlert('æœªæ‰¾åˆ°åˆ†ç±»æ•°æ®', 'danger');
        return;
      }

      // å¡«å……è¡¨å•
      document.getElementById('categoryId').value = category.id;
      document.getElementById('categoryNameZh').value = category.name.zh || '';
      document.getElementById('categoryNameEn').value = category.name.en || '';
      document.getElementById('categoryDesc').value = category.description || '';
      document.getElementById('modalTitle').textContent = 'ç¼–è¾‘åˆ†ç±»';

      // æ˜¾ç¤ºå¯¹è¯æ¡†
      document.getElementById('categoryModal').style.display = 'block';
    }

    /**
     * ä¿å­˜åˆ†ç±»
     */
    function saveCategory() {
      try {
        const categoryId = document.getElementById('categoryId').value;
        const isNewCategory = !categoryId;

        // å‡†å¤‡åˆ†ç±»æ•°æ®
        const categoryData = {
          id: isNewCategory ? generateUniqueId() : categoryId,
          name: {
            zh: document.getElementById('categoryNameZh').value,
            en: document.getElementById('categoryNameEn').value
          },
          description: document.getElementById('categoryDesc').value,
          dateModified: new Date().toISOString()
        };

        // è·å–ç°æœ‰è‡ªå®šä¹‰åˆ†ç±»
        const customCategories = JSON.parse(localStorage.getItem('customCategories') || '[]');

        if (isNewCategory) {
          // æ·»åŠ æ–°åˆ†ç±»
          categoryData.dateAdded = new Date().toISOString();
          customCategories.push(categoryData);
        } else {
          // æ›´æ–°ç°æœ‰åˆ†ç±»
          const index = customCategories.findIndex(c => c.id === categoryId);
          if (index === -1) {
            throw new Error('åˆ†ç±»ä¸å­˜åœ¨');
          }
          customCategories[index] = {
            ...customCategories[index],
            ...categoryData
          };
        }

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        localStorage.setItem('customCategories', JSON.stringify(customCategories));

        // å…³é—­å¯¹è¯æ¡†
        document.getElementById('categoryModal').style.display = 'none';

        // åˆ·æ–°åˆ†ç±»åˆ—è¡¨
        loadCategoriesList();

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        showAlert(isNewCategory ? 'åˆ†ç±»æ·»åŠ æˆåŠŸï¼' : 'åˆ†ç±»æ›´æ–°æˆåŠŸï¼', 'success');
      } catch (error) {
        console.error('ä¿å­˜åˆ†ç±»å¤±è´¥:', error);
        showAlert('ä¿å­˜åˆ†ç±»å¤±è´¥ã€‚', 'danger');
      }
    }

    /**
     * æ‰“å¼€åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
     * @param {string} categoryId - åˆ†ç±»ID
     */
    function openDeleteModal(categoryId) {
      // è·å–åˆ†ç±»æ•°æ®
      const customCategories = JSON.parse(localStorage.getItem('customCategories') || '[]');
      const category = customCategories.find(c => c.id === categoryId);

      if (!category) {
        showAlert('æœªæ‰¾åˆ°åˆ†ç±»æ•°æ®', 'danger');
        return;
      }

      const currentLang = localStorage.getItem('locale') || 'zh';
      
      // è®¾ç½®åˆ†ç±»åç§°
      document.getElementById('deleteCategoryName').textContent = category.name[currentLang] || category.name.en;
      
      // è®¾ç½®ç¡®è®¤æŒ‰é’®çš„åˆ†ç±»ID
      document.getElementById('confirmDeleteBtn').dataset.categoryId = categoryId;
      
      // æ˜¾ç¤ºå¯¹è¯æ¡†
      document.getElementById('deleteConfirmModal').style.display = 'block';

      // æ·»åŠ åˆ é™¤ç¡®è®¤äº‹ä»¶
      document.getElementById('confirmDeleteBtn').onclick = function() {
        deleteCategory(this.dataset.categoryId);
      };
    }

    /**
     * åˆ é™¤åˆ†ç±»
     * @param {string} categoryId - åˆ†ç±»ID
     */
    function deleteCategory(categoryId) {
      try {
        // è·å–è‡ªå®šä¹‰åˆ†ç±»åˆ—è¡¨
        const customCategories = JSON.parse(localStorage.getItem('customCategories') || '[]');
        
        // æŸ¥æ‰¾è¦åˆ é™¤çš„åˆ†ç±»ç´¢å¼•
        const categoryIndex = customCategories.findIndex(c => c.id === categoryId);
        
        if (categoryIndex === -1) {
          showAlert('æœªæ‰¾åˆ°è¦åˆ é™¤çš„åˆ†ç±»', 'danger');
          return;
        }

        // æ£€æŸ¥æ˜¯å¦æœ‰æ¸¸æˆä½¿ç”¨æ­¤åˆ†ç±»
        const gamesUsingCategory = window.gamesData?.filter(game => game.category === categoryId) || [];
        if (gamesUsingCategory.length > 0) {
          showAlert(`æ— æ³•åˆ é™¤æ­¤åˆ†ç±»ï¼Œå› ä¸ºè¿˜æœ‰ ${gamesUsingCategory.length} ä¸ªæ¸¸æˆæ­£åœ¨ä½¿ç”¨å®ƒã€‚`, 'warning');
          document.getElementById('deleteConfirmModal').style.display = 'none';
          return;
        }
        
        // åˆ é™¤åˆ†ç±»
        customCategories.splice(categoryIndex, 1);
        
        // ä¿å­˜å›æœ¬åœ°å­˜å‚¨
        localStorage.setItem('customCategories', JSON.stringify(customCategories));
        
        // å…³é—­å¯¹è¯æ¡†
        document.getElementById('deleteConfirmModal').style.display = 'none';
        
        // åˆ·æ–°åˆ†ç±»åˆ—è¡¨
        loadCategoriesList();
        
        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        showAlert('åˆ†ç±»å·²æˆåŠŸåˆ é™¤ï¼', 'success');
      } catch (error) {
        console.error('åˆ é™¤åˆ†ç±»å¤±è´¥:', error);
        showAlert('åˆ é™¤åˆ†ç±»å¤±è´¥ã€‚', 'danger');
      }
    }

    /**
     * ç”Ÿæˆå”¯ä¸€ID
     * @returns {string} å”¯ä¸€ID
     */
    function generateUniqueId() {
      return 'category_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    /**
     * æ˜¾ç¤ºæé†’æ¶ˆæ¯
     * @param {string} message - æ¶ˆæ¯æ–‡æœ¬
     * @param {string} type - æ¶ˆæ¯ç±»å‹ (success, danger, warning, info)
     */
    function showAlert(message, type) {
      const alertContainer = document.getElementById('alertContainer');
      
      const alert = document.createElement('div');
      alert.className = `alert alert-${type}`;
      alert.textContent = message;
      
      // æ·»åŠ å…³é—­æŒ‰é’®
      const closeBtn = document.createElement('span');
      closeBtn.style.float = 'right';
      closeBtn.style.cursor = 'pointer';
      closeBtn.textContent = 'Ã—';
      closeBtn.addEventListener('click', function() {
        alert.remove();
      });
      
      alert.appendChild(closeBtn);
      alertContainer.prepend(alert);
      
      // 5ç§’åè‡ªåŠ¨å…³é—­
      setTimeout(function() {
        if (alert.parentNode) {
          alert.remove();
        }
      }, 5000);
    }

    /**
     * åˆ‡æ¢ç•Œé¢è¯­è¨€
     */
    function toggleLanguage() {
      // è·å–å½“å‰è¯­è¨€
      let currentLang = localStorage.getItem('locale') || 'zh';
      
      // åˆ‡æ¢è¯­è¨€
      currentLang = currentLang === 'zh' ? 'en' : 'zh';
      localStorage.setItem('locale', currentLang);
      
      // æ›´æ–°æŒ‰é’®æ–‡æœ¬
      document.getElementById('toggleLang').textContent = currentLang === 'zh' ? 'English' : 'ä¸­æ–‡';
      
      // åˆ·æ–°é¡µé¢æ˜¾ç¤º
      loadCategoriesList();
      updateUIText();
    }

    /**
     * æ›´æ–°ç•Œé¢æ–‡æœ¬
     */
    function updateUIText() {
      const currentLang = localStorage.getItem('locale') || 'zh';
      
      const translations = {
        zh: {
          'categories.title': 'AI Stone æ¸¸æˆå¯¼èˆª - åˆ†ç±»ç®¡ç†',
          'categories.heading': 'åˆ†ç±»ç®¡ç†',
          'categories.search': 'æœç´¢åˆ†ç±»...',
          'categories.add': 'æ·»åŠ åˆ†ç±»',
          'categories.loading': 'åŠ è½½åˆ†ç±»æ•°æ®ä¸­...',
          'categories.empty': 'æš‚æ— åˆ†ç±»æ•°æ®ã€‚',
          'categories.click.add': 'ç‚¹å‡»"æ·»åŠ åˆ†ç±»"æŒ‰é’®åˆ›å»ºæ–°åˆ†ç±»ã€‚',
          'categories.action.edit': 'ç¼–è¾‘åˆ†ç±»',
          'categories.action.delete': 'åˆ é™¤åˆ†ç±»',
          'categories.builtin': 'å†…ç½®åˆ†ç±»æ— æ³•ä¿®æ”¹',
          'categories.edit.title': 'ç¼–è¾‘åˆ†ç±»',
          'categories.add.title': 'æ·»åŠ åˆ†ç±»',
          'categories.save': 'ä¿å­˜',
          'categories.cancel': 'å–æ¶ˆ',
          'categories.delete.confirm': 'ç¡®è®¤åˆ é™¤',
          'categories.delete.message': 'æ‚¨ç¡®å®šè¦åˆ é™¤åˆ†ç±» "',
          'categories.delete.message2': '" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚',
          'categories.confirm.delete': 'ç¡®è®¤åˆ é™¤',
          'nav.home': 'é¦–é¡µ',
          'nav.favorites': 'æ”¶è—å¤¹',
          'nav.admin': 'ç®¡ç†'
        },
        en: {
          'categories.title': 'AI Stone Game Navigation - Category Management',
          'categories.heading': 'Category Management',
          'categories.search': 'Search categories...',
          'categories.add': 'Add Category',
          'categories.loading': 'Loading category data...',
          'categories.empty': 'No categories available.',
          'categories.click.add': 'Click "Add Category" button to create a new category.',
          'categories.action.edit': 'Edit Category',
          'categories.action.delete': 'Delete Category',
          'categories.builtin': 'Built-in category cannot be modified',
          'categories.edit.title': 'Edit Category',
          'categories.add.title': 'Add Category',
          'categories.save': 'Save',
          'categories.cancel': 'Cancel',
          'categories.delete.confirm': 'Confirm Deletion',
          'categories.delete.message': 'Are you sure you want to delete the category "',
          'categories.delete.message2': '"? This action cannot be undone.',
          'categories.confirm.delete': 'Confirm Delete',
          'nav.home': 'Home',
          'nav.favorites': 'Favorites',
          'nav.admin': 'Admin'
        }
      };
      
      // è®¾ç½®é¡µé¢æ ‡é¢˜
      document.title = translations[currentLang]['categories.title'];
      document.querySelector('.site-title').textContent = translations[currentLang]['categories.title'];
      
      // æ›´æ–°å¯¼èˆªé“¾æ¥
      const navLinks = document.querySelectorAll('.main-nav a');
      navLinks[0].textContent = translations[currentLang]['nav.home'];
      navLinks[1].textContent = translations[currentLang]['nav.favorites'];
      navLinks[2].textContent = translations[currentLang]['nav.admin'];
      
      // æ›´æ–°é¡µé¢æ ‡é¢˜
      document.querySelector('.admin-title').textContent = translations[currentLang]['categories.heading'];
      
      // æ›´æ–°æœç´¢æ¡†å ä½ç¬¦
      document.getElementById('searchCategories').placeholder = translations[currentLang]['categories.search'];
      
      // æ›´æ–°æ·»åŠ åˆ†ç±»æŒ‰é’®
      document.querySelector('.action-buttons .btn-primary').textContent = 
        translations[currentLang]['categories.add'];
        
      // æ›´æ–°å¯¹è¯æ¡†æ–‡æœ¬
      if (document.querySelector('#categoryModal .modal-header h3')) {
        document.querySelector('#categoryModal .modal-header h3').textContent = 
          document.getElementById('categoryId').value ? 
          translations[currentLang]['categories.edit.title'] : 
          translations[currentLang]['categories.add.title'];
      }
      
      if (document.querySelector('#categoryForm .btn-primary')) {
        document.querySelector('#categoryForm .btn-primary').textContent = 
          translations[currentLang]['categories.save'];
      }
      
      if (document.querySelector('#categoryForm .btn-secondary')) {
        document.querySelector('#categoryForm .btn-secondary').textContent = 
          translations[currentLang]['categories.cancel'];
      }
      
      // æ›´æ–°åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
      if (document.querySelector('#deleteConfirmModal .modal-header h3')) {
        document.querySelector('#deleteConfirmModal .modal-header h3').textContent = 
          translations[currentLang]['categories.delete.confirm'];
      }
      
      const deleteMessageParts = document.querySelector('#deleteConfirmModal .modal-body p');
      if (deleteMessageParts) {
        deleteMessageParts.innerHTML = 
          translations[currentLang]['categories.delete.message'] + 
          `<span id="deleteCategoryName"></span>` + 
          translations[currentLang]['categories.delete.message2'];
      }
      
      if (document.querySelector('#confirmDeleteBtn')) {
        document.querySelector('#confirmDeleteBtn').textContent = 
          translations[currentLang]['categories.confirm.delete'];
      }
      
      if (document.querySelector('#deleteConfirmModal .btn-secondary')) {
        document.querySelector('#deleteConfirmModal .btn-secondary').textContent = 
          translations[currentLang]['categories.cancel'];
      }
    }
  </script>
</body>
</html> 